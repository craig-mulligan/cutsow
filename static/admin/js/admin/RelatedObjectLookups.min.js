// Handles related-objects functionality: lookup link for raw_id_fields
// and Add Another links.
function html_unescape(e){e=e.replace(/&lt;/g,"<");e=e.replace(/&gt;/g,">");e=e.replace(/&quot;/g,'"');e=e.replace(/&#39;/g,"'");e=e.replace(/&amp;/g,"&");return e}function id_to_windowname(e){e=e.replace(/\./g,"__dot__");e=e.replace(/\-/g,"__dash__");return e}function windowname_to_id(e){e=e.replace(/__dot__/g,".");e=e.replace(/__dash__/g,"-");return e}function showRelatedObjectLookupPopup(e){var t=e.id.replace(/^lookup_/,"");t=id_to_windowname(t);var n;e.href.search(/\?/)>=0?n=e.href+"&_popup=1":n=e.href+"?_popup=1";var r=window.open(n,t,"height=500,width=1000,resizable=yes,scrollbars=yes");r.focus();return!1}function dismissRelatedLookupPopup(e,t){var n=windowname_to_id(e.name),r=document.getElementById(n);r.className.indexOf("vManyToManyRawIdAdminField")!=-1&&r.value?r.value+=","+t:document.getElementById(n).value=t;r.focus();e.close()}function removeRelatedObject(e){var t=e.id.replace(/^remove_/,""),n=document.getElementById(t);n.value="";n.focus()}function showAddAnotherPopup(e){var t=e.id.replace(/^add_/,"");t=id_to_windowname(t);var n=e.href;n.indexOf("?")==-1?n+="?_popup=1":n+="&_popup=1";var r=window.open(n,t,"height=500,width=1000,resizable=yes,scrollbars=yes");r.focus();return!1}function dismissAddAnotherPopup(e,t,n){t=html_unescape(t);n=html_unescape(n);var r=windowname_to_id(e.name),i=document.getElementById(r),s;if(i){var o=i.nodeName.toUpperCase();if(o=="SELECT"){s=new Option(n,t);i.options[i.options.length]=s;s.selected=!0}else if(o=="INPUT"){i.className.indexOf("vManyToManyRawIdAdminField")!=-1&&i.value?i.value+=","+t:i.value=t;i.focus()}}else{var u=r+"_to";s=new Option(n,t);SelectBox.add_to_cache(u,s);SelectBox.redisplay(u)}e.close()};